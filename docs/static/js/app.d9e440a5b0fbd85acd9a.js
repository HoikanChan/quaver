webpackJsonp([1],{22:function(t,e,i){"use strict";var n=i(44),o=i.n(n),s=window.navigator;s.getUserMedia=s.getUserMedia||s.webkitGetUserMedia||s.mozGetUserMedia||s.msGetUserMedia;var r=window.AudioContext||window.webkitAudioContext,a=!(!s.getUserMedia||!r),c=a&&new r;e.a={isSupport:a,start:function(){return new o.a(function(t,e){s.getUserMedia({audio:!0},function(e){var i=c.createMediaStreamSource(e),n=c.createAnalyser();i.connect(n),n.fftSize=2048,t(n)},function(){e()})})},getVoiceSize:function(t){var e=new Uint8Array(t.frequencyBinCount);return t.getByteFrequencyData(e),e.slice(100,1e3).reduce(function(t,e){return t+e})}}},38:function(t,e,i){i(79);var n=i(37)(i(42),i(85),null,null);t.exports=n.exports},40:function(t,e,i){"use strict";for(var n=[{height:"50%",width:"900px",marginLeft:0}],o=0;o<50;o++){var s=parseInt(1e3*Math.random()),r=10*(s%3+3),a=40*(s%5+2),c=40*(s%2+1.5);n.push({height:r+"%",width:a+"px",marginLeft:(c<70?70:c)+"px"})}e.a=n},41:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(39),o=i.n(n),s=i(38),r=i.n(s);new o.a({el:"#app",template:"<App/>",components:{App:r.a}})},42:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(22),o=i(84),s=i.n(o);e.default={name:"app",components:{Game:s.a},data:function(){return{isSupport:n.a.isSupport,timer:"",game:{voice:0}}}}},43:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(22),o=i(40),s=void 0;e.default={data:function(){return{timer:"",isStart:!1,isStop:!1,voiceSize:0,sensitivity:1e3,blocks:o.a,blockPosition:0,currentNodeIndex:0,playerBottom:300,autoDown:!1,jumpTimes:0,showPlayer:!1,imgType:1,startTime:new Date,currentTime:new Date,flushGameTime:"",gameOverOpacity:0}},mounted:function(){var t=this;this.$nextTick(function(e){t.showPlayer=!0,t.$watch("voice",function(e){t.inBlock?t.imgType=e%2+1:t.imgType=e%2+4})})},computed:{voice:function(){return parseInt(this.voiceSize/this.sensitivity)},currentNode:function(){return this.$refs.gameWrapper.childNodes[this.currentNodeIndex]},nodeStartPosition:function(){return this.currentNode.offsetLeft},nodeEndPosition:function(){return this.nodeStartPosition+this.currentNode.offsetWidth},playerEL:function(){return this.$refs.player},playerStartPosition:function(){return this.playerEL.offsetLeft+this.blockPosition},playerEndPosition:function(){return this.playerStartPosition+this.playerEL.clientWidth},currentNodeHeight:function(){return this.currentNode.clientHeight},onBlock:function(){return this.playerStartPosition<this.nodeEndPosition&&this.playerEndPosition>this.nodeStartPosition},inBlock:function(){return this.onBlock&&this.playerBottom===this.currentNodeHeight}},watch:{playerBottom:function(t){t<=-50&&this.gameOver()}},methods:{start:function(){var t=this;s?this.gameStart():n.a.start().then(function(e){s=e,t.gameStart()}),this.isStart=!0,this.isStop=!1,this.startTime=new Date,this.flushGameTime=setInterval(function(){t.currentTime=new Date},20),this.$nextTick(function(){t.currentNodeChanged()})},stop:function(){this.isStop=!0,this.stopGetVoiceSize(),this.stopAutoDown(),clearInterval(this.flushGameTime)},gameOver:function(){var t=this;this.gameOverOpacity=1,setTimeout(function(){t.gameOverOpacity=0,t.back()},1200)},back:function(){this.stopGetVoiceSize(),this.stopAutoDown(),this.isStart=!1,this.blockPosition=0,this.currentNodeIndex=0,this.playerBottom=this.$refs.gameWrapper.childNodes[this.currentNodeIndex].clientHeight},gameStart:function(){this.startGetVoiceSize(),this.playerAutoDown()},startGetVoiceSize:function(){var t=this;this.timer=setTimeout(function(){var e=n.a.getVoiceSize(s);t.voiceSize=e,t.voiceChanged(),t.startGetVoiceSize()},5)},currentNodeChanged:function(){this.playerStartPosition>this.nodeEndPosition&&this.currentNodeIndex++,!this.onBlock&&this.playerBottom<this.currentNodeHeight&&this.playerEndPosition>=this.nodeStartPosition&&this.blockPosition--},stopAutoDown:function(){clearInterval(this.autoDown),this.autoDown=""},playerAutoDown:function(){var t=this;this.autoDown||(this.autoDown=setInterval(function(){t.onBlock&&t.playerBottom<=t.currentNodeHeight?t.playerBottom=t.currentNodeHeight:t.playerBottom-=1},10))},jumpPlayer:function(t){this.stopAutoDown(),this.playerBottom+=t,this.jumpTimes>10?(this.jumpTimes=0,this.playerAutoDown()):this.jumpTimes++},voiceChanged:function(){this.voice>3&&(this.blockPosition++,this.currentNodeChanged(),(this.inBlock&&this.voice>40||this.jumpTimes)&&this.jumpPlayer(parseInt(this.voice/5)))},stopGetVoiceSize:function(){clearTimeout(this.timer)}}}},79:function(t,e){},80:function(t,e){},84:function(t,e,i){i(80);var n=i(37)(i(43),i(86),null,null);t.exports=n.exports},85:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app"},[t._m(0),t.isSupport?i("div",{staticClass:"app-container"},[i("game")],1):i("div",{staticClass:"not-support"},[t._v("暂不支持此浏览器，请用谷歌浏览器打开此链接"),i("a",{attrs:{href:"http://www.google.cn/chrome/browser/desktop/index.html",target:"_blank"}},[t._v("谷歌浏览器下载地址")])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{attrs:{href:"https://github.com/k55k32/quaver",target:"_blank"}},[i("img",{staticStyle:{position:"absolute",top:"0",right:"0",border:"0"},attrs:{src:"https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67",alt:"Fork me on GitHub","data-canonical-src":"https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"}})])}]}},86:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.isStart,expression:"isStart"}],staticClass:"game-container"},[i("div",{ref:"player",staticClass:"player",style:{bottom:t.playerBottom+"px"}},[i("img",{attrs:{src:"/static/img/"+t.imgType+".png"}})]),i("div",{staticClass:"game-main-window"},[i("div",{ref:"gameWrapper",staticClass:"game-wrapper",style:{transform:"translate("+-t.blockPosition+"px, 0)"}},t._l(t.blocks,function(t){return i("div",{staticClass:"block",style:t})}))]),i("div",{staticClass:"notice"},[i("div",{staticClass:"time"},[t._v("TIMES: "+t._s((t.currentTime.getTime()-t.startTime.getTime())/1e3))])]),i("div",{staticClass:"stop"},[i("div",{staticClass:"btn",on:{click:t.back}},[t._v("BACK")])]),i("div",{staticClass:"over-mask",style:{opacity:t.gameOverOpacity}})]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isStart,expression:"!isStart"}],staticClass:"game-container"},[i("h1",{staticClass:"desc"},[t._v("八分音符 HTML5 版本")]),i("div",{staticClass:"btn",on:{click:t.start}},[t._v("开始游戏")])])])},staticRenderFns:[]}}},[41]);
//# sourceMappingURL=app.d9e440a5b0fbd85acd9a.js.map